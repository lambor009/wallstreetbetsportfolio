<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<title>wsb portfolio</title>
	<script src="https://code.jquery.com/jquery-3.5.0.js"></script>
	<script src="https://www.chartjs.org/dist/2.9.4/Chart.min.js"></script>
	<script src="https://www.chartjs.org/samples/latest/utils.js"></script>
	<link rel="shortcut icon" href="https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/microsoft/209/rocket_1f680.png"/>
	<style>
	canvas {
		-moz-user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}
	</style>
</head>

<body>
	
	<div style="width:90%; margin:auto;">
		<h3>FAQ</h3>
		<ul>
			<li>What is this website? >> It displays the value of the "WSB Portfolio" over time</li>
			<li>What is the "WSB Portfolio? >> It is a portfolio built by taking the scores from <a href="https://dayminer.herokuapp.com/">this website</a> then weighs each stock based on it's score</li>
			<li>I still don't understand... >> Say there's 10 stocks in the portfolio, the score of all 10 combined is 100. Say GME is one of the 10, and has a individual score of 50, so GME would make up 50% of the portfolio</li>
			<li>How often does it rebalance? >> Every morning after market open, and right before market close.</li>
			<li>What are all the different portfolios? >> wsbtopX is the top X number of stocks on the list. wsbXscore is all the stocks with a score >= X</li>
		</ul>
	</div>
	
	<center>
		<div style="width:75%;">
			<canvas id="canvas"></canvas>
		</div>
	</center>
	<br>
	<br>
	<script>
		var basedatetime_json = JSON.parse($.getJSON({
				'url': 'wsbtop1_history.json',
				'async': false
			}).responseText);
		var config = {
			type: 'line',
			data: {
				labels: basedatetime_json.datetime,
				datasets: []
			},
			options: {
				responsive: true,
				title: {
					display: true,
					text: 'WallStreetBets Portfolio Performance'
				},
				tooltips: {
					mode: 'index',
					intersect: false,
				},
				hover: {
					mode: 'nearest',
					intersect: true
				},
				scales: {
					xAxes: [{
						display: true,
						scaleLabel: {
							display: true,
							labelString: 'Month'
						}
					}],
					yAxes: [{
						display: true,
						scaleLabel: {
							display: true,
							labelString: 'Value'
						}
					}]
				}
			}
		};
		window.onload = function() {
			var ctx = document.getElementById('canvas').getContext('2d');
			window.myLine = new Chart(ctx, config);
		};
		var portfolios = ["wsbtop1", "wsbtop10", "wsbtop50", "wsbtop100", "wsb1000score", "wsb100score"]
		var iter_port;
		for (iter_port = 0; iter_port < portfolios.length; iter_port++) {
			
			var json = JSON.parse($.getJSON({
				'url': portfolios[iter_port] + '_history.json',
				'async': false
			}).responseText);
			console.log("portfolioname = " + portfolios[iter_port]);
			console.log(json);
			
			var colorNames = Object.keys(window.chartColors);
			var colorName = colorNames[config.data.datasets.length % colorNames.length];
			var newColor = window.chartColors[colorName];
			var newDataset = {
				label: portfolios[iter_port],
				backgroundColor: newColor,
				borderColor: newColor,
				data: json.values,
				fill: false
			};
			config.data.datasets.push(newDataset);
		}
		
		//window.myLine.update();

			//var dates = [];
			//var histvalues = [];
			//var mod_histvalues = [];
			//var i;
			//for(i = 0; i < json.datetime.length; i++) {
			//	console.log("creating dates and hist values array");
			//	dates.push(json.datetime[i]);
			//	histvalues.push(json.values[i]);
			//}
			//var j;
			//for(j = 0; j < 3; j++) {
			//	console.log(dates[j]);
			//	console.log(histvalues[j]);
			//	mod_histvalues.push(histvalues[j] * 1.5);
			//}
			
	</script>
</body>
