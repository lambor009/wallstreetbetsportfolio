<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<title>wsb portfolio</title>
	<script src="https://code.jquery.com/jquery-3.5.0.js"></script>
	<script src="https://www.chartjs.org/dist/2.9.4/Chart.min.js"></script>
	<script src="https://www.chartjs.org/samples/latest/utils.js"></script>
	<style>
	canvas {
		-moz-user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}
	</style>
</head>

<body>
	<div style="width:75%;">
		<canvas id="canvas"></canvas>
	</div>
	<br>
	<br>
	<p> hello 5</p>
	<script>
		var basedatetime_json = JSON.parse($.getJSON({
				'url': 'wsbtop100_history.json',
				'async': false
			}).responseText);
		var config = {
			type: 'line',
			data: {
				labels: basedatetime_json.datetime,
				datasets: [{
					label: 'My base dataset',
					fill: false,
					backgroundColor: window.chartColors.blue,
					borderColor: window.chartColors.blue,
					data: [
						randomScalingFactor(),
						randomScalingFactor(),
						randomScalingFactor(),
						randomScalingFactor(),
						randomScalingFactor(),
						randomScalingFactor(),
						randomScalingFactor()
					],
				}]
			},
			options: {
				responsive: true,
				title: {
					display: true,
					text: 'Chart.js Line Chart'
				},
				tooltips: {
					mode: 'index',
					intersect: false,
				},
				hover: {
					mode: 'nearest',
					intersect: true
				},
				scales: {
					xAxes: [{
						display: true,
						scaleLabel: {
							display: true,
							labelString: 'Month'
						}
					}],
					yAxes: [{
						display: true,
						scaleLabel: {
							display: true,
							labelString: 'Value'
						}
					}]
				}
			}
		};
		window.onload = function() {
			var ctx = document.getElementById('canvas').getContext('2d');
			window.myLine = new Chart(ctx, config);
		};
		var portfolios = ["wsbtop1", "wsbtop10", "wsbtop50", "wsbtop100", "wsb1000score", "wsb100score"]
		var iter_port;
		for (iter_port = 0; portfolios.length; iter_port++) {
			
			var json = JSON.parse($.getJSON({
				'url': portfolios[iter_port] + '_history.json',
				'async': false
			}).responseText);
			console.log("portfolioname = " + portfolios[iter_port]);
			console.log(json);
			
			var colorNames = Object.keys(window.chartColors);
			var colorName = colorNames[config.data.datasets.length % colorNames.length];
			var newColor = window.chartColors[colorName];
			var newDataset = {
				label: 'Dataset ' + portfolios[iter_port],
				backgroundColor: newColor,
				borderColor: newColor,
				data: json.values,
				fill: false
			};
			config.data.datasets.push(newDataset);
			window.myLine.update();
		}
			//var dates = [];
			//var histvalues = [];
			//var mod_histvalues = [];
			//var i;
			//for(i = 0; i < json.datetime.length; i++) {
			//	console.log("creating dates and hist values array");
			//	dates.push(json.datetime[i]);
			//	histvalues.push(json.values[i]);
			//}
			//var j;
			//for(j = 0; j < 3; j++) {
			//	console.log(dates[j]);
			//	console.log(histvalues[j]);
			//	mod_histvalues.push(histvalues[j] * 1.5);
			//}
			
	</script>
</body>
